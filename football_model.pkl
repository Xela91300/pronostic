# Dans Colab ou local Python
import pandas as pd
import joblib
from lightgbm import LGBMClassifier
from sklearn.calibration import CalibratedClassifierCV
from sklearn.model_selection import train_test_split

# Exemple ultra-simple (remplace par ton vrai dataset)
# Télécharge https://www.football-data.co.uk/mmz4281/2425/E0.csv par ex.
df = pd.read_csv("https://www.football-data.co.uk/mmz4281/2425/E0.csv")  # Premier League exemple

# Features basiques + target (1 = home win, 0 = draw/away pour simplifier)
df["home_win"] = (df["FTHG"] > df["FTAG"]).astype(int)
features = ["FTHG", "FTAG", "HS", "AS"]  # shots etc. – adapte !

X = df[features].fillna(0)
y = df["home_win"]

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

lgb = LGBMClassifier(n_estimators=100, learning_rate=0.05, random_state=42)
calibrated = CalibratedClassifierCV(lgb, method='isotonic', cv=3)
calibrated.fit(X_train, y_train)

joblib.dump(calibrated, "football_model.pkl")
print("Modèle sauvegardé !")
